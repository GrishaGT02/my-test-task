(()=>{"use strict";function e(){return"_"+Math.random().toString(36).substr(2,9)}tinymce.init({selector:"#editor",menubar:!1,toolbar:!1,height:500,branding:!1,content_style:'\n    body { background: #fff; color: #222; font-size: 16px; }\n    select[data-template-dropdown="true"] {\n      padding: 6px 16px;\n      border-radius: 6px;\n      border: 2px solid #5e5;\n      background: #222;\n      color: #fff;\n      font-size: 1em;\n      margin: 4px 8px 4px 0;\n      outline: none;\n      transition: border 0.2s, background 0.2s;\n      font-family: inherit;\n      min-width: 120px;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n    }\n    select[data-template-dropdown="true"]:hover,\n    select[data-template-dropdown="true"]:focus {\n      border: 2px solid #8f8;\n      background: #333;\n    }\n    select[data-template-dropdown="true"]:focus option {\n      background: #444;\n      color: #fff;\n    }\n    .error {\n      display: inline-block;\n      padding: 6px 16px;\n      border-radius: 6px;\n      background: #e55;\n      color: #fff;\n      font-weight: bold;\n      margin: 4px 8px 4px 0;\n      font-size: 1em;\n      letter-spacing: 1px;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n    }\n  ',setup:function(e){e.on("keydown",function(t){if("Delete"===t.key){var n=e.selection.getRng();if(n.collapsed){var o=n.startContainer,a=n.startOffset,r=null;3===o.nodeType?a===o.length&&(r=o.nextSibling):1===o.nodeType&&(r=o.childNodes[a]),r&&"SELECT"===r.nodeName&&"true"===r.getAttribute("data-template-dropdown")&&(r.remove(),t.preventDefault())}}})}});var t=[{id:e(),text:"template 1"},{id:e(),text:"template 2"},{id:e(),text:"template 3"}],n=0,o=document.getElementById("templates-list"),a=document.getElementById("add-template"),r=document.getElementById("remove-template"),i=document.getElementById("edit-template-input");function d(){o.innerHTML="",t.forEach(function(e,t){var a=document.createElement("li");a.textContent=e.text,a.className=t===n?"selected":"",a.onclick=function(){n=t,d(),l()},o.appendChild(a)})}function l(){void 0!==t[n]?(i.value=t[n].text,i.disabled=!1):(i.value="",i.disabled=!0)}function c(){d(),l(),function(){var e=tinymce.activeEditor;if(e){var n=e.getBody(),o=!1;n.querySelectorAll('select[data-template-dropdown="true"]').forEach(function(e){var n=e.value;if(t.find(function(e){return e.id===n})){var a=e.value;e.innerHTML="",t.forEach(function(t){var n=document.createElement("option");n.value=t.id,n.textContent=t.text,e.appendChild(n)}),t.find(function(e){return e.id===a})?e.value=a:t.length>0&&(e.value=t[0].id),o=!0}else{var r=document.createElement("span");r.className="error",r.textContent="ERROR",e.parentNode.replaceChild(r,e),o=!0}}),o&&e.nodeChanged()}}()}function u(){if(void 0!==t[n]){var e=t[n].text;t[n].text=i.value,e!==i.value&&(d(),l(),function(){var e=tinymce.activeEditor;if(e){var n=e.getBody().querySelectorAll('select[data-template-dropdown="true"]'),o=!1;n.forEach(function(e){var n=e.value;if(e.innerHTML="",t.forEach(function(t){var n=document.createElement("option");n.value=t.id,n.textContent=t.text,e.appendChild(n)}),t.find(function(e){return e.id===n}))e.value=n;else if(n){var a=document.createElement("option");a.value=n,a.textContent="[удалено]",a.disabled=!0,a.selected=!0,e.insertBefore(a,e.firstChild),e.value=n}else t.length>0&&(e.value=t[0].id);o=!0}),o&&e.nodeChanged()}}())}}a.onclick=function(){t.push({id:e(),text:"template"}),n=t.length-1,c()},r.onclick=function(){0!==t.length&&(t.splice(n,1),n>=t.length&&(n=t.length-1),c())},i.addEventListener("keydown",function(e){"Enter"===e.key&&(u(),i.blur())}),i.addEventListener("blur",u),document.getElementById("insert-btn").onclick=function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t.length)return'<span class="error">ERROR</span>';var n=t.map(function(t){return'<option value="'.concat(t.id,'"').concat(t.id===e?" selected":"",">").concat(t.text,"</option>")}).join("");return'<select data-template-dropdown="true">'.concat(n,"</select>")}(t[0]?t[0].id:null);tinymce.activeEditor.execCommand("mceInsertContent",!1,e)},c()})();
//# sourceMappingURL=bundle.js.map